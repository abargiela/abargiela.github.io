---
layout: post
title: Script para monitorar conexões
date: '2010-10-27T16:46:00.007-02:00'
author: Alexandre Bargiela
tags: 
modified_time: '2012-12-27T15:22:30.495-02:00'
blogger_id: tag:blogger.com,1999:blog-7490778459153845376.post-6233604161638502022
blogger_orig_url: http://abargiela.blogspot.com/2010/10/script-para-monitorar-conexoes.html
---

Bom, necessitei monitorar as conexões vinda de uma determinada porta, então criei um script monitora_conn.sh, coisa simples, ai vai ele:<br /><br /><a href="https://github.com/abargiela/scripts/blob/master/monitora_conn.sh">https://github.com/abargiela/scripts/blob/master/monitora_conn.sh</a><br /><br /><a href="http://pastebin.com/GDVxZb0H" style="font-family: &quot;Courier New&quot;,Courier,monospace;">http://pastebin.com/GDVxZb0H</a><br /><br /><div style="background-color: white; color: black;"><span style="background-color: white;">Como eu precisei deixar esse script rodando durante um tempo eu executei ele da seguinte forma:</span><br /><span style="background-color: white;"> </span><br /><span style="background-color: white;"> <span style="background-color: black; color: lime; font-family: &quot;Courier New&quot;,Courier,monospace;">(sh /path/script/monitora_conn.sh &amp;)</span></span><br /><span style="background-color: white;"> </span><br /><br /><div style="background-color: white; color: black;"><span style="background-color: white;">- Para verificar o log&nbsp;</span></div><div style="background-color: white; color: black;"><span style="background-color: white;"> </span></div><div style="background-color: white; color: black; font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="background-color: black; color: lime;">tail -f /tmp/log_conn_80.txt</span></div><div style="background-color: white; color: black;"><span style="background-color: white;"><br /></span></div><div style="background-color: white; color: black;"><span style="background-color: white;">- Caso precise que ele pare de rodar basta:</span></div><div style="background-color: white; color: black;"><span style="background-color: white;"> </span></div><div style="background-color: white; color: black; font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="background-color: white;">ps auxwww | grep -i monitora_conn.sh</span></div><div style="background-color: white; color: black; font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="background-color: white;">root&nbsp;&nbsp;&nbsp;&nbsp; 24536&nbsp; 0.0&nbsp; 0.0&nbsp; 63864&nbsp; 1136 pts/0&nbsp;&nbsp;&nbsp; S&nbsp;&nbsp;&nbsp; 15:57&nbsp;&nbsp; 0:00 sh /path/script/monitora_conn.sh</span></div><br /><span style="background-color: white;">- Pegue o PID e mate o processo.</span><br /><span style="background-color: white;"><span style="background-color: black; color: lime; font-family: &quot;Courier New&quot;,Courier,monospace;">kill -9&nbsp; 24536</span> #Óbvio, mate o processo referente ao que estiver rodando no momento, o meu é apenas ilustrativo.</span><br /><br /><span style="background-color: white;"> </span><br /><span style="background-color: white;">- Críticas construtivas serão muito bem vindas =D</span></div>